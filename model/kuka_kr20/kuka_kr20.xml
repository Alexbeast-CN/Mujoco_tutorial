<mujoco model="kuka_kr20">
    <include file="../scene.xml" />

    <extension>
        <plugin plugin="mujoco.elasticity.cable" />
    </extension>

    <compiler angle="radian" boundmass="0.001" boundinertia="0.001" meshdir="." />

    <option integrator="implicitfast" timestep="0.005" solver="Newton" iterations="100" />

    <default>
        <default class="kuka">
            <joint axis="0 0 1" />
            <general gaintype="fixed" biastype="affine" gainprm="2000" biasprm="0 -2000 -200" />
            <default class="visual">
                <geom type="mesh" contype="0" conaffinity="0" group="1" />
            </default>
            <default class="collision">
                <geom group="2" />
            </default>
        </default>
    </default>

    <asset>
        <material name="kuka_black"
            rgba="0.054901960784313725 0.054901960784313725 0.06274509803921569 1" />
        <material name="kuka_orange"
            rgba="0.9647058823529412 0.47058823529411764 0.1568627450980392 1" />
        <material name="silver" rgba="0.7 0.7 0.7 1" />

        <mesh name="base_link" file="assets/base_link.stl" scale="0.001 0.001 0.001" />
        <mesh name="link_1_1" file="assets/link_1_1.stl" scale="0.001 0.001 0.001" />
        <mesh name="link_2_1" file="assets/link_2_1.stl" scale="0.001 0.001 0.001" />
        <mesh name="link_3_1" file="assets/link_3_1.stl" scale="0.001 0.001 0.001" />
        <mesh name="link_4_1" file="assets/link_4_1.stl" scale="0.001 0.001 0.001" />
        <mesh name="link_5_1" file="assets/link_5_1.stl" scale="0.001 0.001 0.001" />
        <mesh name="link_6_1" file="assets/link_6_1.stl" scale="0.001 0.001 0.001" />
    </asset>

    <worldbody>
        <body name="base_link" pos="0 0 0">
            <inertial pos="-0.02519167908195973 -0.0003512237430115979 0.14073533087089485"
                mass="2.7534689254296694"
                diaginertia="4.167631 5.193899 5.744846" />
            <geom type="mesh" name="base_link_mesh" mesh="base_link" material="kuka_black" />

            <!-- Link 1 -->
            <body name="link_1_1" pos="0 0 0.274469">
                <inertial pos="0.04262669771195508 0.022539294966451077 0.16742328594359268"
                    mass="1.95025233840842"
                    diaginertia="3.903396 4.254089 4.101512" />
                <joint name="joint_1" axis="0 0 1" limited="true"
                    range="-3.2288591161895095 3.2288591161895095" />
                <geom type="mesh" name="link_1_1_mesh" pos="0 0 -0.274469" mesh="link_1_1"
                    material="kuka_orange" />

                <!-- Link 2 -->
                <body name="link_2_1" pos="0.16 -0.0948 0.245531">
                    <inertial pos="-0.006708726638690016 -0.08230603603988629 0.35023181950025006"
                        mass=".8242519331073362"
                        diaginertia="4.984932 5.021308 0.256664" />
                    <joint name="joint_2" axis="0 -1 0" limited="true"
                        range="-3.2288591161895095 1.1344640137963142" />
                    <geom type="mesh" name="link_2_1_mesh" pos="-0.16 0.0948 -0.52" mesh="link_2_1"
                        material="kuka_orange" />

                    <!-- Link 3 -->
                    <body name="link_3_1" pos="0 -0.0203 0.78">
                        <inertial pos="0.03856241201011176 0.11370205937926676 0.07616220977557053"
                            mass="1.1562183723958658"
                            diaginertia="1.475083 2.199261 2.25828" />
                        <joint name="joint_3" axis="0 1 0" limited="true"
                            range="-2.4085543677521746 3.0543261909900763" />
                        <geom type="mesh" name="link_3_1_mesh" pos="-0.16 0.1151 -1.3"
                            mesh="link_3_1" material="kuka_orange" />

                        <!-- 线缆末尾连接处 -->
                        <body name="cable_end" pos="0.20052409 0.19378685 0.26059563">
                            <!-- 不参与碰撞 -->
                            <geom type="sphere" size="0.02" rgba="1 0 0 1" contype="2"
                                conaffinity="2" />
                        </body>

                        <!-- 线缆滑轨连接处 -->
                        <body name="moveable_ring" pos="0.09262699 0.0396 0.25999994">
                            <joint name="slider" type="slide" axis="1.0 0.0 0.0" armature="0.01"
                                springdamper="0.1 1.0" range="-0.15 0.15" />
                            <!-- 不参与碰撞 -->
                            <geom type="sphere" size="0.02" rgba="1 0 0 1" contype="2"
                                conaffinity="2" />
                        </body>
                        <!-- Link 4 -->
                        <body name="link_4_1" pos="0.3 0.1151 0.15">
                            <inertial
                                pos="0.2794641231700052 0.005705547665961539 -1.1441231588804612e-06"
                                mass=".47719118331815324"
                                diaginertia="0.089286 1.63285 1.644056" />
                            <joint name="joint_4" axis="1 0 0" limited="true"
                                range="-6.108652381980153 6.108652381980153" />
                            <geom type="mesh" name="link_4_1_mesh" pos="-0.46 0 -1.45"
                                mesh="link_4_1" material="kuka_orange" />
                            <!-- Link 5 -->
                            <body name="link_5_1" pos="0.56 0.0923 0">
                                <inertial
                                    pos="0.05739426005238135 -0.10605062717888086 -4.807006906970557e-06"
                                    mass=".10353274319603718"
                                    diaginertia="0.043336 0.032453 0.064603" />
                                <joint name="joint_5" axis="0 1 0" limited="true"
                                    range="-2.2689280275926285 2.2689280275926285" />
                                <geom type="mesh" name="link_5_1_mesh" pos="-1.02 -0.0923 -1.45"
                                    mesh="link_5_1" material="kuka_orange" />

                                <!-- Link 6 -->
                                <body name="link_6_1" pos="0.139 -0.0923 0">
                                    <inertial
                                        pos="0.008129076502710442 -2.0340839963698945e-14 8.253251104872739e-05"
                                        mass="0.0020169644458108382"
                                        diaginertia="0.000104 5.5e-05 5.4e-05" />
                                    <joint name="joint_6" axis="1 0 0" limited="true"
                                        range="-6.108652381980153 6.108652381980153" />
                                    <geom type="mesh" name="link_6_1_mesh" pos="-1.159 0 -1.45"
                                        mesh="link_6_1" material="silver" />
                                    <!-- 线缆开头连接处-->
                                    <body name="cable_start"
                                        pos="1.39999781e-02 -2.03503884e-14  1.00099969e-01">
                                        <!-- 不参与碰撞 -->
                                        <geom type="sphere" size="0.02" rgba="1 0 0 1" contype="2"
                                            conaffinity="2" />
                                    </body>
                                </body>
                            </body>
                        </body>
                    </body>
                </body>
            </body>
        </body>

        <composite prefix="cable_" type="cable" initial="free"
            vertex="1.173 -2.035038760769826e-14 1.5501
                    1.1271210871831956 -0.00550410536899651 1.5508217303733076
                    1.082021735810635 -0.010854992263792603 1.5515233698472732
                    1.0377086872037387 -0.01605133571510753 1.5522047446842056
                    0.9941934832430787 -0.021090867230388697 1.5528655574261436
                    0.9514926542645905 -0.025970337863874954 1.5535053820523934
                    0.9096277387948266 -0.030685514337742116 1.5541236634709006
                    0.8686252347637651 -0.035231188630954445 1.5547197187756034
                    0.8285164889620685 -0.03960119970582692 1.555292740095341
                    0.7893374362019769 -0.04378848477450353 1.5558418013162145
                    0.7511282751386602 -0.04778514301447087 1.5563658664363393
                    0.7139330343854015 -0.05158252084621026 1.5568638007479427
                    0.6777988659245153 -0.05517135080935897 1.557334389047619
                    0.6427752291157259 -0.058541911941333784 1.5577763566661085
                    0.6089130192593233 -0.06168420105340481 1.5581883919270139
                    0.5762635659023844 -0.0645881296080469 1.5585691719625054
                    0.54487756962749 -0.06724373268721497 1.5589173901144608
                    0.5148037715594933 -0.06964143049340261 1.559231790224005
                    0.4860869493972265 -0.07177242221848511 1.5595112182778923
                    0.45876565696219046 -0.07362913032287574 1.5597546806649734
                    0.43287018300189856 -0.07520560172139708 1.5599613967820298
                    0.4084210924656161 -0.07649779448743639 1.5601308366280902
                    0.3854280356444025 -0.07750381190985917 1.5602627514953378
                    0.363889564679005 -0.0782239385573643 1.5603571786980792
                    0.34379548482950656 -0.0786601781494874 1.560414380975697
                    0.3251301898627426 -0.07881559800472036 1.5604347605328661
                    0.3078756608018942 -0.07869373965292611 1.5604187817556219
                    0.29201351264307407 -0.07829821656455582 1.5603669184632663
                    0.27752666581888974 -0.07763238563376458 1.5602796108313235
                    0.2644009977845785 -0.07669902256832536 1.560157222826772
                    0.2526269807627071 -0.0755 1.56
                    0.20243266849882433 -0.07251517482349448 1.5597241537233149
                    0.15756463332953502 -0.06841970982939255 1.5595307839276695
                    0.11794519580234038 -0.06325513218116559 1.5594169506615905
                    0.08346177407884796 -0.05708619656148049 1.5593780796834198
                    0.05397987893685368 -0.04999748959329717 1.5594082107225335
                    0.029356047051159493 -0.042090048763537294 1.5595002446728792
                    0.009449169521708569 -0.03347835841359021 1.5596461630264633
                    -0.005872253201249578 -0.024288302899482958 1.5598371768390638
                    -0.016724461144683716 -0.014655496818887798 1.5600638479358924
                    -0.02320284636155918 -0.004723629740700423 1.5603162090495721
                    -0.02537641258659221 0.005357185117087908 1.5605838836303587
                    -0.023283485673319292 0.01543195955387495 1.5608561971347874
                    -0.01693059909144239 0.025342118465529598 1.561122266682641
                    -0.006292630205484357 0.03492668526783082 1.5613710821923386
                    0.008687015339575766 0.0440234633716125 1.5615915871885755
                    0.028096169013007 0.0524702272469552 1.5617727602081064
                    0.05205235908176121 0.060106162802590964 1.5619037117571872
                    0.08069795579607743 0.06677394064238908 1.561973820746335
                    0.11419401086381754 0.07232203863705498 1.561972886476745
                    0.15271404670514188 0.07660707408487599 1.5618912812248564
                    0.19643777830320844 0.07949615778262832 1.5617201042496893
                    0.24554308255164245 0.08086981776067642 1.561451372792331
                    0.3001935189399495 0.08062636908871477 1.5610783069785703
                    0.3605240977356938 0.07868685334570223 1.5605956517136854
                    0.42662698076270716 0.07499999999995752 1.56">
            <plugin plugin="mujoco.elasticity.cable">
                <config key="twist" value="1e5" />
                <config key="bend" value="4e5" />
                <config key="vmax" value="0.05" />
                <config key="flat" value="true" />
            </plugin>
            <joint kind="main" damping="1" />
            <geom type="capsule" mass="0.0001" size=".01" condim="1" />
        </composite>

    </worldbody>

    <equality>
        <!-- 线缆与机器人之间的约束 -->
        <weld name="cable_start" body1="cable_B_first" body2="cable_start" anchor="0 0 0"
            solimp="0.95 0.99 0.0001" solref="0.0001 1" />
        <weld name="cable_end" body1="cable_B_last" body2="cable_end" anchor="0 0 0"
            solimp="0.95 0.99 0.0001" solref="0.0001 1" />
        <weld name="slider_weld" body1="cable_B_30" body2="moveable_ring" anchor="0 0 0"
            solimp="0.95 0.99 0.0001" solref="0.0001 1" />
    </equality>

    <contact>
        <exclude body1="base_link" body2="link_1_1" />
        <exclude body1="link_1_1" body2="link_2_1" />
        <exclude body1="link_2_1" body2="link_3_1" />
        <exclude body1="link_3_1" body2="link_4_1" />
        <exclude body1="link_4_1" body2="link_5_1" />
        <exclude body1="link_5_1" body2="link_6_1" />
    </contact>

</mujoco>